# Copilot Instructions for Projek-Romiyahya

## Project Overview
This is a Laravel 10 web application with role-based access control (admin/user). The stack combines:
- **Backend**: Laravel 10 with Eloquent ORM, Sanctum API auth
- **Frontend**: Blade templates with Tailwind CSS and Alpine.js
- **Build**: Vite for asset bundling
- **Database**: MySQL (configured in `.env`)

## Critical Architecture Patterns

### Authentication & Authorization
- User roles stored in `users.role` column (migration: `2025_11_16_030307_add_role_to_users_table.php`)
- Default roles: `'admin'` and `'user'` (see `AdminSeeder.php`)
- Admin routes protected by custom `'admin'` middleware (see `routes/web.php` - duplicate dashboard routes for admin vs user)
- API auth via Laravel Sanctum (`auth:sanctum` middleware in `routes/api.php`)
- Credentials: Admin seed creates `admin@example.com` / `password`

### Routing & Middleware
- **Web routes** (`routes/web.php`): Handle Blade template rendering, apply CSRF protection via middleware group
- **API routes** (`routes/api.php`): Minimal setup, primarily for Sanctum token-based requests
- **Auth routes** (`routes/auth.php`): Auto-generated by Laravel Breeze (login, register, etc.)
- Middleware stack in `app/Http/Kernel.php`:
  - Global: CORS, trimming strings, null conversion
  - Web group: cookies, sessions, CSRF, binding
  - API group: Sanctum stateless, request throttling

### Data Flow & Models
- Single `User` model (`app/Models/User.php`) using `HasApiTokens`, `HasFactory`, `Notifiable` traits
- Mass-assignable fields: `name`, `email`, `password` (no `role` exposed for mass assignment by default)
- Hidden fields: `password`, `remember_token`
- Profile management via `ProfileController` (create, update, destroy profile)

## Developer Workflows

### Local Setup
```bash
# Install PHP dependencies
composer install

# Install Node dependencies  
npm install

# Create environment file (copy from .env.example)
php artisan key:generate

# Run migrations
php artisan migrate

# Seed database (creates admin user)
php artisan db:seed DatabaseSeeder

# Start dev server
php artisan serve

# In separate terminal: build frontend assets
npm run dev
```

### Building & Running
- **Development**: `php artisan serve` starts app on `http://localhost:8000`
- **Frontend watch**: `npm run dev` runs Vite in dev mode with hot reload
- **Production build**: `npm run build` compiles assets to `public/build/`
- **Asset manifest**: Auto-generated at `public/build/manifest.json` (required for Vite to load assets)

### Testing
- **Test config**: `phpunit.xml` defines Unit and Feature test suites
- **Run all tests**: `php artisan test` or `vendor/bin/phpunit`
- **Environment**: Tests run with `APP_ENV=testing`, in-memory cache, array mail driver
- **Test location**: `tests/Unit/` and `tests/Feature/`
- **Base class**: Tests extend `Tests\TestCase` which uses `CreatesApplication` trait

### Code Quality
- **Linting**: Laravel Pint (`vendor/bin/pint`) - PSR-12 standard
- **PHP version**: 8.1+ required (strict types, constructor property promotion expected)

## Key Conventions & Gotchas

### Blade Template Patterns
- Views in `resources/views/` compiled to `storage/framework/views/`
- Layouts in `resources/views/layouts/` (e.g., `app.blade.php` for main layout)
- Components in `resources/views/components/` with namespace `App\View\Components`
- Shared view data via middleware or service provider (`AppServiceProvider`)

### Frontend Asset Pipeline
- CSS entry: `resources/css/app.css` (imported into `resources/js/app.js`)
- Tailwind config in `tailwind.config.js` scans `resources/views/**/*.blade.php` for classes
- Alpine.js available globally for interactive components
- Vite injects assets via `@vite` directive in Blade layout

### Database & Migrations
- Migrations in `database/migrations/` follow timestamp + name convention
- Always include `down()` method for rollback support
- User factory in `database/factories/UserFactory.php` for seeding test data
- Role column default: `'user'` (set in migration)

### PSR-4 Autoloading
- `App\` → `app/`
- `Database\Factories\` → `database/factories/`
- `Database\Seeders\` → `database/seeders/`
- `Tests\` → `tests/`

## Common Commands Reference
- `php artisan migrate` - Run pending migrations
- `php artisan migrate:fresh --seed` - Reset DB + seed admin user
- `php artisan tinker` - Interactive shell for model inspection
- `php artisan route:list` - Display all routes with middleware
- `php artisan make:model ModelName -m` - Generate model + migration
- `php artisan make:controller ControllerName` - Generate controller
- `npm run build` - Production asset build (must do before deployment)

## Files to Know
- `config/app.php` - App name, timezone, service providers
- `config/auth.php` - Authentication guards and providers (API uses Sanctum)
- `app/Providers/RouteServiceProvider.php` - Route registration & model binding
- `.env` - Environment variables (DB credentials, app key, etc.) - **never commit**
- `vite.config.js` - Asset build config (entry points, refresh on Blade changes)

---
**Last Updated**: Nov 16, 2025 | **Laravel Version**: 10.x | **PHP**: 8.1+
